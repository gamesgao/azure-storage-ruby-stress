<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>module Mocha::ObjectMethods - mocha-1.3.0 Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
  var index_rel_prefix = "../";
</script>

<script src="../js/jquery.js"></script>
<script src="../js/darkfish.js"></script>

<link href="../css/fonts.css" rel="stylesheet">
<link href="../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="module">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../table_of_contents.html#pages">Pages</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    
    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-i-expects">#expects</a>
    
    <li ><a href="#method-i-method_exists-3F">#method_exists?</a>
    
    <li ><a href="#method-i-mocha">#mocha</a>
    
    <li ><a href="#method-i-mocha_inspect">#mocha_inspect</a>
    
    <li ><a href="#method-i-reset_mocha">#reset_mocha</a>
    
    <li ><a href="#method-i-stubba_method">#stubba_method</a>
    
    <li ><a href="#method-i-stubba_object">#stubba_object</a>
    
    <li ><a href="#method-i-stubs">#stubs</a>
    
    <li ><a href="#method-i-to_matcher">#to_matcher</a>
    
    <li ><a href="#method-i-unstub">#unstub</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="module-Mocha::ObjectMethods">
  <h1 id="module-Mocha::ObjectMethods" class="module">
    module Mocha::ObjectMethods
  </h1>

  <section class="description">
    
<p>Methods added to all objects to allow mocking and stubbing on real (i.e.
non-mock) objects.</p>

<p>Both {#expects} and {#stubs} return an {Expectation} which can be further
modified by methods on {Expectation}.</p>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-expects" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">expects</span><span
            class="method-args">(expected_methods_vs_return_values)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Adds an expectation that the specified method must be called exactly once
with any parameters.</p>

<p>The original implementation of the method is replaced during the test and
then restored at the end of the test. The temporary replacement method has
the same visibility as the original method.</p>

<p>@param [Symbol,String] method_name name of expected method @param [Hash]
expected_methods_vs_return_values expected method name symbols as keys and
corresponding return values as values - these expectations are setup as if
{#expects} were called multiple times.</p>

<p>@overload def expects(method_name) @overload def
expects(expected_methods_vs_return_values) @return [Expectation] last-built
expectation which can be further modified by methods on {Expectation}.
@raise [StubbingError] if attempting to stub method which is not allowed.</p>

<p>@example Setting up an expectation on a non-mock object.</p>

<pre class="ruby"><span class="ruby-identifier">product</span> = <span class="ruby-constant">Product</span>.<span class="ruby-identifier">new</span>
<span class="ruby-identifier">product</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">save</span>).<span class="ruby-identifier">returns</span>(<span class="ruby-keyword">true</span>)
<span class="ruby-identifier">assert_equal</span> <span class="ruby-keyword">true</span>, <span class="ruby-identifier">product</span>.<span class="ruby-identifier">save</span>
</pre>

<p>@example Setting up multiple expectations on a non-mock object.</p>

<pre class="ruby"><span class="ruby-identifier">product</span> = <span class="ruby-constant">Product</span>.<span class="ruby-identifier">new</span>
<span class="ruby-identifier">product</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">valid?</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>, :<span class="ruby-identifier">save</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>)

<span class="ruby-comment"># exactly equivalent to</span>

<span class="ruby-identifier">product</span> = <span class="ruby-constant">Product</span>.<span class="ruby-identifier">new</span>
<span class="ruby-identifier">product</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">valid?</span>).<span class="ruby-identifier">returns</span>(<span class="ruby-keyword">true</span>)
<span class="ruby-identifier">product</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">save</span>).<span class="ruby-identifier">returns</span>(<span class="ruby-keyword">true</span>)
</pre>

<p>@see <a href="Mock.html#method-i-expects">Mocha::Mock#expects</a></p>
          
          

          
          <div class="method-source-code" id="expects-source">
            <pre><span class="ruby-comment"># File lib/mocha/object_methods.rb, line 64</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">expects</span>(<span class="ruby-identifier">expected_methods_vs_return_values</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">expected_methods_vs_return_values</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/the[^a-z]*spanish[^a-z]*inquisition/i</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">ExpectationErrorFactory</span>.<span class="ruby-identifier">build</span>(<span class="ruby-string">&#39;NOBODY EXPECTS THE SPANISH INQUISITION!&#39;</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">frozen?</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">StubbingError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;can&#39;t stub method on frozen object: #{mocha_inspect}&quot;</span>, <span class="ruby-identifier">caller</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">expectation</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">mockery</span> = <span class="ruby-constant">Mocha</span><span class="ruby-operator">::</span><span class="ruby-constant">Mockery</span>.<span class="ruby-identifier">instance</span>
  <span class="ruby-identifier">iterator</span> = <span class="ruby-constant">ArgumentIterator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">expected_methods_vs_return_values</span>)
  <span class="ruby-identifier">iterator</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-operator">*</span><span class="ruby-identifier">args</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">method_name</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">shift</span>
    <span class="ruby-identifier">mockery</span>.<span class="ruby-identifier">on_stubbing</span>(<span class="ruby-keyword">self</span>, <span class="ruby-identifier">method_name</span>)
    <span class="ruby-identifier">method</span> = <span class="ruby-identifier">stubba_method</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">stubba_object</span>, <span class="ruby-identifier">method_name</span>)
    <span class="ruby-identifier">mockery</span>.<span class="ruby-identifier">stubba</span>.<span class="ruby-identifier">stub</span>(<span class="ruby-identifier">method</span>)
    <span class="ruby-identifier">expectation</span> = <span class="ruby-identifier">mocha</span>.<span class="ruby-identifier">expects</span>(<span class="ruby-identifier">method_name</span>, <span class="ruby-identifier">caller</span>)
    <span class="ruby-identifier">expectation</span>.<span class="ruby-identifier">returns</span>(<span class="ruby-identifier">args</span>.<span class="ruby-identifier">shift</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
  }
  <span class="ruby-identifier">expectation</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-method_exists-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">method_exists?</span><span
            class="method-args">(method, include_public_methods = true)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@private</p>
          
          

          
          <div class="method-source-code" id="method_exists-3F-source">
            <pre><span class="ruby-comment"># File lib/mocha/object_methods.rb, line 163</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">method_exists?</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">include_public_methods</span> = <span class="ruby-keyword">true</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">include_public_methods</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">public_methods</span>(<span class="ruby-identifier">include_superclass_methods</span> = <span class="ruby-keyword">true</span>).<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">method</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">method</span>.<span class="ruby-identifier">to_sym</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">protected_methods</span>(<span class="ruby-identifier">include_superclass_methods</span> = <span class="ruby-keyword">true</span>).<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">method</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">private_methods</span>(<span class="ruby-identifier">include_superclass_methods</span> = <span class="ruby-keyword">true</span>).<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">method</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-mocha" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">mocha</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@private</p>
          
          

          
          <div class="method-source-code" id="mocha-source">
            <pre><span class="ruby-comment"># File lib/mocha/object_methods.rb, line 17</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">mocha</span>
  <span class="ruby-ivar">@mocha</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">Mocha</span><span class="ruby-operator">::</span><span class="ruby-constant">Mockery</span>.<span class="ruby-identifier">instance</span>.<span class="ruby-identifier">mock_impersonating</span>(<span class="ruby-keyword">self</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-mocha_inspect" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">mocha_inspect</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="mocha_inspect-source">
            <pre><span class="ruby-comment"># File lib/mocha/inspect.rb, line 6</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">mocha_inspect</span>
  <span class="ruby-identifier">address</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">__id__</span> <span class="ruby-operator">*</span> <span class="ruby-value">2</span>
  <span class="ruby-identifier">address</span> <span class="ruby-operator">+=</span> <span class="ruby-value">0x100000000</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">address</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>
  <span class="ruby-identifier">inspect</span> <span class="ruby-operator">=~</span> <span class="ruby-node">/#&lt;/</span> <span class="ruby-operator">?</span> <span class="ruby-node">&quot;#&lt;#{self.class}:0x#{&#39;%x&#39; % address}&gt;&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">inspect</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-reset_mocha" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">reset_mocha</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@private</p>
          
          

          
          <div class="method-source-code" id="reset_mocha-source">
            <pre><span class="ruby-comment"># File lib/mocha/object_methods.rb, line 22</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">reset_mocha</span>
  <span class="ruby-ivar">@mocha</span> = <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-stubba_method" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">stubba_method</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@private</p>
          
          

          
          <div class="method-source-code" id="stubba_method-source">
            <pre><span class="ruby-comment"># File lib/mocha/object_methods.rb, line 27</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">stubba_method</span>
  <span class="ruby-constant">Mocha</span><span class="ruby-operator">::</span><span class="ruby-constant">InstanceMethod</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-stubba_object" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">stubba_object</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@private</p>
          
          

          
          <div class="method-source-code" id="stubba_object-source">
            <pre><span class="ruby-comment"># File lib/mocha/object_methods.rb, line 32</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">stubba_object</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-stubs" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">stubs</span><span
            class="method-args">(stubbed_methods_vs_return_values)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Adds an expectation that the specified method may be called any number of
times with any parameters.</p>

<p>The original implementation of the method is replaced during the test and
then restored at the end of the test. The temporary replacement method has
the same visibility as the original method.</p>

<p>@param [Symbol,String] method_name name of stubbed method @param [Hash]
stubbed_methods_vs_return_values stubbed method name symbols as keys and
corresponding return values as values - these stubbed methods are setup as
if {#stubs} were called multiple times.</p>

<p>@overload def stubs(method_name) @overload def
stubs(stubbed_methods_vs_return_values) @return [Expectation] last-built
expectation which can be further modified by methods on {Expectation}.
@raise [StubbingError] if attempting to stub method which is not allowed.</p>

<p>@example Setting up a stubbed methods on a non-mock object.</p>

<pre class="ruby"><span class="ruby-identifier">product</span> = <span class="ruby-constant">Product</span>.<span class="ruby-identifier">new</span>
<span class="ruby-identifier">product</span>.<span class="ruby-identifier">stubs</span>(:<span class="ruby-identifier">save</span>).<span class="ruby-identifier">returns</span>(<span class="ruby-keyword">true</span>)
<span class="ruby-identifier">assert_equal</span> <span class="ruby-keyword">true</span>, <span class="ruby-identifier">product</span>.<span class="ruby-identifier">save</span>
</pre>

<p>@example Setting up multiple stubbed methods on a non-mock object.</p>

<pre class="ruby"><span class="ruby-identifier">product</span> = <span class="ruby-constant">Product</span>.<span class="ruby-identifier">new</span>
<span class="ruby-identifier">product</span>.<span class="ruby-identifier">stubs</span>(:<span class="ruby-identifier">valid?</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>, :<span class="ruby-identifier">save</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>)

<span class="ruby-comment"># exactly equivalent to</span>

<span class="ruby-identifier">product</span> = <span class="ruby-constant">Product</span>.<span class="ruby-identifier">new</span>
<span class="ruby-identifier">product</span>.<span class="ruby-identifier">stubs</span>(:<span class="ruby-identifier">valid?</span>).<span class="ruby-identifier">returns</span>(<span class="ruby-keyword">true</span>)
<span class="ruby-identifier">product</span>.<span class="ruby-identifier">stubs</span>(:<span class="ruby-identifier">save</span>).<span class="ruby-identifier">returns</span>(<span class="ruby-keyword">true</span>)
</pre>

<p>@see <a href="Mock.html#method-i-stubs">Mocha::Mock#stubs</a></p>
          
          

          
          <div class="method-source-code" id="stubs-source">
            <pre><span class="ruby-comment"># File lib/mocha/object_methods.rb, line 113</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">stubs</span>(<span class="ruby-identifier">stubbed_methods_vs_return_values</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">frozen?</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">StubbingError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;can&#39;t stub method on frozen object: #{mocha_inspect}&quot;</span>, <span class="ruby-identifier">caller</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">expectation</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">mockery</span> = <span class="ruby-constant">Mocha</span><span class="ruby-operator">::</span><span class="ruby-constant">Mockery</span>.<span class="ruby-identifier">instance</span>
  <span class="ruby-identifier">iterator</span> = <span class="ruby-constant">ArgumentIterator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">stubbed_methods_vs_return_values</span>)
  <span class="ruby-identifier">iterator</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-operator">*</span><span class="ruby-identifier">args</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">method_name</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">shift</span>
    <span class="ruby-identifier">mockery</span>.<span class="ruby-identifier">on_stubbing</span>(<span class="ruby-keyword">self</span>, <span class="ruby-identifier">method_name</span>)
    <span class="ruby-identifier">method</span> = <span class="ruby-identifier">stubba_method</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">stubba_object</span>, <span class="ruby-identifier">method_name</span>)
    <span class="ruby-identifier">mockery</span>.<span class="ruby-identifier">stubba</span>.<span class="ruby-identifier">stub</span>(<span class="ruby-identifier">method</span>)
    <span class="ruby-identifier">expectation</span> = <span class="ruby-identifier">mocha</span>.<span class="ruby-identifier">stubs</span>(<span class="ruby-identifier">method_name</span>, <span class="ruby-identifier">caller</span>)
    <span class="ruby-identifier">expectation</span>.<span class="ruby-identifier">returns</span>(<span class="ruby-identifier">args</span>.<span class="ruby-identifier">shift</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
  }
  <span class="ruby-identifier">expectation</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-to_matcher" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_matcher</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@private</p>
          
          

          
          <div class="method-source-code" id="to_matcher-source">
            <pre><span class="ruby-comment"># File lib/mocha/parameter_matchers/object.rb, line 7</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_matcher</span>
  <span class="ruby-constant">Mocha</span><span class="ruby-operator">::</span><span class="ruby-constant">ParameterMatchers</span><span class="ruby-operator">::</span><span class="ruby-constant">Equals</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">self</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-unstub" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">unstub</span><span
            class="method-args">(*method_names)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Removes the specified stubbed methods (added by calls to {#expects} or
{#stubs}) and all expectations associated with them.</p>

<p>Restores the original behaviour of the methods before they were stubbed.
This is normally done automatically at the end of each test, but in some
circumstances you may want to do it <strong>before</strong> the end of the
test.</p>

<p>WARNING: If you {#unstub} a method which still has unsatisfied
expectations, you may be removing the only way those expectations can be
satisfied. Use {#unstub} with care.</p>

<p>@param [Array&lt;Symbol&gt;] method_names names of methods to unstub.</p>

<p>@example Stubbing and unstubbing a method on a real (non-mock) object.</p>

<pre class="ruby"><span class="ruby-identifier">multiplier</span> = <span class="ruby-constant">Multiplier</span>.<span class="ruby-identifier">new</span>
<span class="ruby-identifier">multiplier</span>.<span class="ruby-identifier">double</span>(<span class="ruby-value">2</span>) <span class="ruby-comment"># =&gt; 4</span>
<span class="ruby-identifier">multiplier</span>.<span class="ruby-identifier">stubs</span>(:<span class="ruby-identifier">double</span>).<span class="ruby-identifier">raises</span> <span class="ruby-comment"># new behaviour defined</span>
<span class="ruby-identifier">multiplier</span>.<span class="ruby-identifier">double</span>(<span class="ruby-value">2</span>) <span class="ruby-comment"># =&gt; raises exception</span>
<span class="ruby-identifier">multiplier</span>.<span class="ruby-identifier">unstub</span>(:<span class="ruby-identifier">double</span>) <span class="ruby-comment"># original behaviour restored</span>
<span class="ruby-identifier">multiplier</span>.<span class="ruby-identifier">double</span>(<span class="ruby-value">2</span>) <span class="ruby-comment"># =&gt; 4</span>
</pre>

<p>@example Unstubbing multiple methods on a real (non-mock) object.</p>

<pre class="ruby"><span class="ruby-identifier">multiplier</span>.<span class="ruby-identifier">unstub</span>(:<span class="ruby-identifier">double</span>, :<span class="ruby-identifier">triple</span>)

<span class="ruby-comment"># exactly equivalent to</span>

<span class="ruby-identifier">multiplier</span>.<span class="ruby-identifier">unstub</span>(:<span class="ruby-identifier">double</span>)
<span class="ruby-identifier">multiplier</span>.<span class="ruby-identifier">unstub</span>(:<span class="ruby-identifier">triple</span>)
</pre>
          
          

          
          <div class="method-source-code" id="unstub-source">
            <pre><span class="ruby-comment"># File lib/mocha/object_methods.rb, line 154</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">unstub</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">method_names</span>)
  <span class="ruby-identifier">mockery</span> = <span class="ruby-constant">Mocha</span><span class="ruby-operator">::</span><span class="ruby-constant">Mockery</span>.<span class="ruby-identifier">instance</span>
  <span class="ruby-identifier">method_names</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">method_name</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">method</span> = <span class="ruby-identifier">stubba_method</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">stubba_object</span>, <span class="ruby-identifier">method_name</span>)
    <span class="ruby-identifier">mockery</span>.<span class="ruby-identifier">stubba</span>.<span class="ruby-identifier">unstub</span>(<span class="ruby-identifier">method</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://rdoc.github.io/rdoc">RDoc</a> 5.1.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

