<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class Capybara::Session - capybara-2.16.1 Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
  var index_rel_prefix = "../";
</script>

<script src="../js/jquery.js"></script>
<script src="../js/darkfish.js"></script>

<link href="../css/fonts.css" rel="stylesheet">
<link href="../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../table_of_contents.html#pages">Pages</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link"><a href="../Object.html">Object</a>
  
</div>

    <div id="includes-section" class="nav-section">
  <h3>Included Modules</h3>

  <ul class="link-list">
  
  
    <li><a class="include" href="Minitest/Expectations.html">Capybara::Minitest::Expectations</a>
  
  
  
    <li><a class="include" href="SessionMatchers.html">Capybara::SessionMatchers</a>
  
  
  </ul>
</div>

    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-instance_created-3F">::instance_created?</a>
    
    <li ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-i-_find_frame">#_find_frame</a>
    
    <li ><a href="#method-i-_switch_to_window">#_switch_to_window</a>
    
    <li ><a href="#method-i-accept_alert">#accept_alert</a>
    
    <li ><a href="#method-i-accept_confirm">#accept_confirm</a>
    
    <li ><a href="#method-i-accept_modal">#accept_modal</a>
    
    <li ><a href="#method-i-accept_prompt">#accept_prompt</a>
    
    <li ><a href="#method-i-body">#body</a>
    
    <li ><a href="#method-i-cleanup-21">#cleanup!</a>
    
    <li ><a href="#method-i-config">#config</a>
    
    <li ><a href="#method-i-configure">#configure</a>
    
    <li ><a href="#method-i-current_host">#current_host</a>
    
    <li ><a href="#method-i-current_path">#current_path</a>
    
    <li ><a href="#method-i-current_scope">#current_scope</a>
    
    <li ><a href="#method-i-current_url">#current_url</a>
    
    <li ><a href="#method-i-current_window">#current_window</a>
    
    <li ><a href="#method-i-default_fn">#default_fn</a>
    
    <li ><a href="#method-i-dismiss_confirm">#dismiss_confirm</a>
    
    <li ><a href="#method-i-dismiss_modal">#dismiss_modal</a>
    
    <li ><a href="#method-i-dismiss_prompt">#dismiss_prompt</a>
    
    <li ><a href="#method-i-document">#document</a>
    
    <li ><a href="#method-i-driver">#driver</a>
    
    <li ><a href="#method-i-element_script_result">#element_script_result</a>
    
    <li ><a href="#method-i-evaluate_async_script">#evaluate_async_script</a>
    
    <li ><a href="#method-i-evaluate_script">#evaluate_script</a>
    
    <li ><a href="#method-i-execute_script">#execute_script</a>
    
    <li ><a href="#method-i-go_back">#go_back</a>
    
    <li ><a href="#method-i-go_forward">#go_forward</a>
    
    <li ><a href="#method-i-html">#html</a>
    
    <li ><a href="#method-i-inspect">#inspect</a>
    
    <li ><a href="#method-i-modal_options">#modal_options</a>
    
    <li ><a href="#method-i-open_file">#open_file</a>
    
    <li ><a href="#method-i-open_new_window">#open_new_window</a>
    
    <li ><a href="#method-i-prepare_path">#prepare_path</a>
    
    <li ><a href="#method-i-raise_server_error-21">#raise_server_error!</a>
    
    <li ><a href="#method-i-refresh">#refresh</a>
    
    <li ><a href="#method-i-reset-21">#reset!</a>
    
    <li ><a href="#method-i-reset_session-21">#reset_session!</a>
    
    <li ><a href="#method-i-response_headers">#response_headers</a>
    
    <li ><a href="#method-i-save_and_open_page">#save_and_open_page</a>
    
    <li ><a href="#method-i-save_and_open_screenshot">#save_and_open_screenshot</a>
    
    <li ><a href="#method-i-save_page">#save_page</a>
    
    <li ><a href="#method-i-save_screenshot">#save_screenshot</a>
    
    <li ><a href="#method-i-scopes">#scopes</a>
    
    <li ><a href="#method-i-source">#source</a>
    
    <li ><a href="#method-i-status_code">#status_code</a>
    
    <li ><a href="#method-i-switch_to_frame">#switch_to_frame</a>
    
    <li ><a href="#method-i-switch_to_window">#switch_to_window</a>
    
    <li ><a href="#method-i-using_wait_time">#using_wait_time</a>
    
    <li ><a href="#method-i-visit">#visit</a>
    
    <li ><a href="#method-i-window_opened_by">#window_opened_by</a>
    
    <li ><a href="#method-i-windows">#windows</a>
    
    <li ><a href="#method-i-within">#within</a>
    
    <li ><a href="#method-i-within_element">#within_element</a>
    
    <li ><a href="#method-i-within_fieldset">#within_fieldset</a>
    
    <li ><a href="#method-i-within_frame">#within_frame</a>
    
    <li ><a href="#method-i-within_table">#within_table</a>
    
    <li ><a href="#method-i-within_window">#within_window</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-Capybara::Session">
  <h1 id="class-Capybara::Session" class="class">
    class Capybara::Session
  </h1>

  <section class="description">
    
<p>The <a href="Session.html">Session</a> class represents a single user&#39;s
interaction with the system. The <a href="Session.html">Session</a> can use
any of the underlying drivers. A session can be initialized manually like
this:</p>

<pre class="ruby"><span class="ruby-identifier">session</span> = <span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">Session</span>.<span class="ruby-identifier">new</span>(:<span class="ruby-identifier">culerity</span>, <span class="ruby-constant">MyRackApp</span>)
</pre>

<p>The application given as the second argument is optional. When running <a
href="../Capybara.html">Capybara</a> against an external page, you might
want to leave it out:</p>

<pre class="ruby"><span class="ruby-identifier">session</span> = <span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">Session</span>.<span class="ruby-identifier">new</span>(:<span class="ruby-identifier">culerity</span>)
<span class="ruby-identifier">session</span>.<span class="ruby-identifier">visit</span>(<span class="ruby-string">&#39;http://www.google.com&#39;</span>)
</pre>

<p>When Capybara.threadsafe == true the sessions options will be initially set
to the current values of the global options and a configuration block can
be passed to the session initializer. For available options see
{Capybara::SessionConfig::OPTIONS}</p>

<pre class="ruby"><span class="ruby-identifier">session</span> = <span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">Session</span>.<span class="ruby-identifier">new</span>(:<span class="ruby-identifier">driver</span>, <span class="ruby-constant">MyRackApp</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">config</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">config</span>.<span class="ruby-identifier">app_host</span> = <span class="ruby-string">&quot;http://my_host.dev&quot;</span>
<span class="ruby-keyword">end</span>
</pre>

<p><a href="Session.html">Session</a> provides a number of methods for
controlling the navigation of the page, such as <code>visit</code>,
+current_path, and so on. It also delegate a number of methods to a
Capybara::Document, representing the current HTML document. This allows
interaction:</p>

<pre class="ruby"><span class="ruby-identifier">session</span>.<span class="ruby-identifier">fill_in</span>(<span class="ruby-string">&#39;q&#39;</span>, <span class="ruby-identifier">with</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;Capybara&#39;</span>)
<span class="ruby-identifier">session</span>.<span class="ruby-identifier">click_button</span>(<span class="ruby-string">&#39;Search&#39;</span>)
<span class="ruby-identifier">expect</span>(<span class="ruby-identifier">session</span>).<span class="ruby-identifier">to</span> <span class="ruby-identifier">have_content</span>(<span class="ruby-string">&#39;Capybara&#39;</span>)
</pre>

<p>When using capybara/dsl, the <a href="Session.html">Session</a> is
initialized automatically for you.</p>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    
    <section class="constants-list">
      <header>
        <h3>Constants</h3>
      </header>
      <dl>
      
        <dt id="DOCUMENT_METHODS">DOCUMENT_METHODS
        
        <dd><p>@api private</p>
        
      
        <dt id="DSL_METHODS">DSL_METHODS
        
        <dd>
        
      
        <dt id="MODAL_METHODS">MODAL_METHODS
        
        <dd>
        
      
        <dt id="NODE_METHODS">NODE_METHODS
        
        <dd>
        
      
        <dt id="SESSION_METHODS">SESSION_METHODS
        
        <dd>
        
      
      </dl>
    </section>
    

    
    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      
      <div id="attribute-i-app" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">app</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-mode" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">mode</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-server" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">server</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-synchronized" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">synchronized</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
    </section>
    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-instance_created-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">instance_created?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="instance_created-3F-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 857</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">instance_created?</span>
  <span class="ruby-identifier">@@instance_created</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(mode, app=nil) { |config| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 77</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">mode</span>, <span class="ruby-identifier">app</span>=<span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-string">&quot;The second parameter to Session::new should be a rack app if passed.&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">app</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">app</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:call</span>)
  <span class="ruby-identifier">@@instance_created</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-ivar">@mode</span> = <span class="ruby-identifier">mode</span>
  <span class="ruby-ivar">@app</span> = <span class="ruby-identifier">app</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;A configuration block is only accepted when Capybara.threadsafe == true&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-constant">Capybara</span>.<span class="ruby-identifier">threadsafe</span>
    <span class="ruby-keyword">yield</span> <span class="ruby-identifier">config</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">config</span>.<span class="ruby-identifier">run_server</span> <span class="ruby-keyword">and</span> <span class="ruby-ivar">@app</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">needs_server?</span>
    <span class="ruby-ivar">@server</span> = <span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">Server</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@app</span>, <span class="ruby-identifier">config</span>.<span class="ruby-identifier">server_port</span>, <span class="ruby-identifier">config</span>.<span class="ruby-identifier">server_host</span>, <span class="ruby-identifier">config</span>.<span class="ruby-identifier">server_errors</span>).<span class="ruby-identifier">boot</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@server</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@touched</span> = <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-accept_alert" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">accept_alert</span><span
            class="method-args">(text_or_options=nil, options={}, &blk)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Execute the block, accepting a alert.</p>

<p>@!macro modal_params</p>

<pre>Expects a block whose actions will trigger the display modal to appear
@example
  $0 do
    click_link(&#39;link that triggers appearance of system modal&#39;)
  end
@overload $0(text, options = {}, &amp;blk)
  @param text [String, Regexp]  Text or regex to match against the text in the modal.  If not provided any modal is matched
  @option options [Numeric] :wait (Capybara.default_max_wait_time) Maximum time to wait for the modal to appear after executing the block.
  @yield Block whose actions will trigger the system modal
@overload $0(options = {}, &amp;blk)
  @option options [Numeric] :wait (Capybara.default_max_wait_time) Maximum time to wait for the modal to appear after executing the block.
  @yield Block whose actions will trigger the system modal
@return [String]  the message shown in the modal
@raise [Capybara::ModalNotFound]  if modal dialog hasn&#39;t been found</pre>
          
          

          
          <div class="method-source-code" id="accept_alert-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 683</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">accept_alert</span>(<span class="ruby-identifier">text_or_options</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">options</span>={}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">blk</span>)
  <span class="ruby-identifier">accept_modal</span>(<span class="ruby-value">:alert</span>, <span class="ruby-identifier">text_or_options</span>, <span class="ruby-identifier">options</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">blk</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-accept_confirm" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">accept_confirm</span><span
            class="method-args">(text_or_options=nil, options={}, &blk)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Execute the block, accepting a confirm.</p>

<p>@macro modal_params</p>
          
          

          
          <div class="method-source-code" id="accept_confirm-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 693</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">accept_confirm</span>(<span class="ruby-identifier">text_or_options</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">options</span>={}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">blk</span>)
  <span class="ruby-identifier">accept_modal</span>(<span class="ruby-value">:confirm</span>, <span class="ruby-identifier">text_or_options</span>, <span class="ruby-identifier">options</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">blk</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-accept_prompt" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">accept_prompt</span><span
            class="method-args">(text_or_options=nil, options={}, &blk)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Execute the block, accepting a prompt, optionally responding to the prompt.</p>

<p>@macro modal_params @option options [String] :with   Response to provide to
the prompt</p>
          
          

          
          <div class="method-source-code" id="accept_prompt-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 714</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">accept_prompt</span>(<span class="ruby-identifier">text_or_options</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">options</span>={}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">blk</span>)
  <span class="ruby-identifier">accept_modal</span>(<span class="ruby-value">:prompt</span>, <span class="ruby-identifier">text_or_options</span>, <span class="ruby-identifier">options</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">blk</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-body" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">body</span><span
            class="method-args">()</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Session.html#method-i-html">html</a>
        </div>
        
      </div>

    
      <div id="method-i-cleanup-21" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">cleanup!</span><span
            class="method-args">()</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Session.html#method-i-reset-21">reset!</a>
        </div>
        
      </div>

    
      <div id="method-i-config" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">config</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="config-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 861</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">config</span>
  <span class="ruby-ivar">@config</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">Capybara</span>.<span class="ruby-identifier">threadsafe</span>
    <span class="ruby-constant">Capybara</span>.<span class="ruby-identifier">session_options</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">ReadOnlySessionConfig</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">Capybara</span>.<span class="ruby-identifier">session_options</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-configure" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">configure</span><span
            class="method-args">() { |config| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Accepts a block to set the configuration options if Capybara.threadsafe ==
true. Note that some options only have an effect if set at initialization
time, so look at the configuration block that can be passed to the
initializer too</p>
          
          

          
          <div class="method-source-code" id="configure-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 852</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">configure</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Session configuration is only supported when Capybara.threadsafe == true&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-constant">Capybara</span>.<span class="ruby-identifier">threadsafe</span>
  <span class="ruby-keyword">yield</span> <span class="ruby-identifier">config</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-current_host" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">current_host</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@return [String] Host of the current page</p>
          
          

          
          <div class="method-source-code" id="current_host-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 206</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">current_host</span>
  <span class="ruby-identifier">uri</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">current_url</span>)
  <span class="ruby-node">&quot;#{uri.scheme}://#{uri.host}&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">host</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-current_path" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">current_path</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@return [String] Path of the current page, without any domain information</p>
          
          

          
          <div class="method-source-code" id="current_path-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 189</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">current_path</span>
  <span class="ruby-comment"># Addressable parsing is more lenient than URI</span>
  <span class="ruby-identifier">uri</span> = <span class="ruby-operator">::</span><span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">current_url</span>)

  <span class="ruby-comment"># If current_url ends up being nil, won&#39;t be able to call .path on a NilClass.</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">nil?</span>

  <span class="ruby-comment"># Addressable doesn&#39;t support opaque URIs - we want nil here</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;about&quot;</span>
  <span class="ruby-identifier">path</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>
  <span class="ruby-identifier">path</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">path</span> <span class="ruby-keyword">and</span> <span class="ruby-keyword">not</span> <span class="ruby-identifier">path</span>.<span class="ruby-identifier">empty?</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-current_scope" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">current_scope</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="current_scope-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 823</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">current_scope</span>
  <span class="ruby-identifier">scope</span> = <span class="ruby-identifier">scopes</span>.<span class="ruby-identifier">last</span>
  <span class="ruby-identifier">scope</span> = <span class="ruby-identifier">document</span> <span class="ruby-keyword">if</span> [<span class="ruby-keyword">nil</span>, <span class="ruby-value">:frame</span>].<span class="ruby-identifier">include?</span> <span class="ruby-identifier">scope</span>
  <span class="ruby-identifier">scope</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-current_url" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">current_url</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@return [String] Fully qualified URL of the current page</p>
          
          

          
          <div class="method-source-code" id="current_url-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 215</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">current_url</span>
  <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">current_url</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-current_window" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">current_window</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@return [Capybara::Window]   current window</p>
          
          

          
          <div class="method-source-code" id="current_window-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 451</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">current_window</span>
  <span class="ruby-constant">Window</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">self</span>, <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">current_window_handle</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-dismiss_confirm" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">dismiss_confirm</span><span
            class="method-args">(text_or_options=nil, options={}, &blk)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Execute the block, dismissing a confirm.</p>

<p>@macro modal_params</p>
          
          

          
          <div class="method-source-code" id="dismiss_confirm-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 703</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">dismiss_confirm</span>(<span class="ruby-identifier">text_or_options</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">options</span>={}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">blk</span>)
  <span class="ruby-identifier">dismiss_modal</span>(<span class="ruby-value">:confirm</span>, <span class="ruby-identifier">text_or_options</span>, <span class="ruby-identifier">options</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">blk</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-dismiss_prompt" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">dismiss_prompt</span><span
            class="method-args">(text_or_options=nil, options={}, &blk)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Execute the block, dismissing a prompt.</p>

<p>@macro modal_params</p>
          
          

          
          <div class="method-source-code" id="dismiss_prompt-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 724</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">dismiss_prompt</span>(<span class="ruby-identifier">text_or_options</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">options</span>={}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">blk</span>)
  <span class="ruby-identifier">dismiss_modal</span>(<span class="ruby-value">:prompt</span>, <span class="ruby-identifier">text_or_options</span>, <span class="ruby-identifier">options</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">blk</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-document" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">document</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="document-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 802</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">document</span>
  <span class="ruby-ivar">@document</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">Node</span><span class="ruby-operator">::</span><span class="ruby-constant">Document</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">self</span>, <span class="ruby-identifier">driver</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-driver" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">driver</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="driver-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 94</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">driver</span>
  <span class="ruby-ivar">@driver</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword">begin</span>
    <span class="ruby-keyword">unless</span> <span class="ruby-constant">Capybara</span>.<span class="ruby-identifier">drivers</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">mode</span>)
      <span class="ruby-identifier">other_drivers</span> = <span class="ruby-constant">Capybara</span>.<span class="ruby-identifier">drivers</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">inspect</span> }
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">DriverNotFoundError</span>, <span class="ruby-node">&quot;no driver called #{mode.inspect} was found, available drivers: #{other_drivers.join(&#39;, &#39;)}&quot;</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">driver</span> = <span class="ruby-constant">Capybara</span>.<span class="ruby-identifier">drivers</span>[<span class="ruby-identifier">mode</span>].<span class="ruby-identifier">call</span>(<span class="ruby-identifier">app</span>)
    <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">session</span> = <span class="ruby-keyword">self</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:session=</span>)
    <span class="ruby-identifier">driver</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-evaluate_async_script" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">evaluate_async_script</span><span
            class="method-args">(script, *args)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Evaluate the given JavaScript and obtain the result from a callback
function which will be passed as the last argument to the script.</p>

<p>@param  [String] script   A string of JavaScript to evaluate @return
[Object]          The result of the evaluated JavaScript (may be driver
specific)</p>
          
          

          
          <div class="method-source-code" id="evaluate_async_script-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 651</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">evaluate_async_script</span>(<span class="ruby-identifier">script</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
  <span class="ruby-ivar">@touched</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-identifier">result</span> = <span class="ruby-keyword">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">evaluate_async_script</span>(<span class="ruby-identifier">script</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">NotSupportedByDriverError</span>, <span class="ruby-string">&quot;The current driver does not support evaluate_async_script arguments&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">method</span>(<span class="ruby-value">:evaluate_async_script</span>).<span class="ruby-identifier">arity</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
    <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">evaluate_async_script</span>(<span class="ruby-identifier">script</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">arg</span><span class="ruby-operator">|</span> <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">Node</span><span class="ruby-operator">::</span><span class="ruby-constant">Element</span>) <span class="ruby-operator">?</span>  <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">base</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">arg</span>} )
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">element_script_result</span>(<span class="ruby-identifier">result</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-evaluate_script" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">evaluate_script</span><span
            class="method-args">(script, *args)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Evaluate the given JavaScript and return the result. Be careful when using
this with scripts that return complex objects, such as jQuery statements.
<code>execute_script</code> might be a better alternative.</p>

<p>@param  [String] script   A string of JavaScript to evaluate @return
[Object]          The result of the evaluated JavaScript (may be driver
specific)</p>
          
          

          
          <div class="method-source-code" id="evaluate_script-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 633</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">evaluate_script</span>(<span class="ruby-identifier">script</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
  <span class="ruby-ivar">@touched</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-identifier">result</span> = <span class="ruby-keyword">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">evaluate_script</span>(<span class="ruby-identifier">script</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">NotSupportedByDriverError</span>, <span class="ruby-string">&quot;The current driver does not support evaluate_script arguments&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">method</span>(<span class="ruby-value">:evaluate_script</span>).<span class="ruby-identifier">arity</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
    <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">evaluate_script</span>(<span class="ruby-identifier">script</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">arg</span><span class="ruby-operator">|</span> <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">Node</span><span class="ruby-operator">::</span><span class="ruby-constant">Element</span>) <span class="ruby-operator">?</span>  <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">base</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">arg</span>} )
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">element_script_result</span>(<span class="ruby-identifier">result</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-execute_script" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">execute_script</span><span
            class="method-args">(script, *args)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Execute the given script, not returning a result. This is useful for
scripts that return complex objects, such as jQuery statements.
<code>execute_script</code> should be used over
<code>evaluate_script</code> whenever possible.</p>

<p>@param [String] script   A string of JavaScript to execute @param args 
Optional arguments that will be passed to the script.  <a
href="Driver.html">Driver</a> support for this is optional and types of
objects supported may differ between drivers</p>
          
          

          
          <div class="method-source-code" id="execute_script-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 614</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">execute_script</span>(<span class="ruby-identifier">script</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
  <span class="ruby-ivar">@touched</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">execute_script</span>(<span class="ruby-identifier">script</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">NotSupportedByDriverError</span>, <span class="ruby-string">&quot;The current driver does not support execute_script arguments&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">method</span>(<span class="ruby-value">:execute_script</span>).<span class="ruby-identifier">arity</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
    <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">execute_script</span>(<span class="ruby-identifier">script</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">arg</span><span class="ruby-operator">|</span> <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">Node</span><span class="ruby-operator">::</span><span class="ruby-constant">Element</span>) <span class="ruby-operator">?</span>  <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">base</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">arg</span>} )
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-go_back" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">go_back</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Move back a single entry in the browser&#39;s history.</p>
          
          

          
          <div class="method-source-code" id="go_back-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 291</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">go_back</span>
  <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">go_back</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-go_forward" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">go_forward</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Move forward a single entry in the browser&#39;s history.</p>
          
          

          
          <div class="method-source-code" id="go_forward-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 299</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">go_forward</span>
  <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">go_forward</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-html" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">html</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@return [String] A snapshot of the DOM of the current document, as it looks
right now (potentially modified by JavaScript).</p>
          
          

          
          <div class="method-source-code" id="html-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 179</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">html</span>
  <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">html</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Session.html#method-i-body">body</a>, <a href="Session.html#method-i-source">source</a>
        </div>
        

        
      </div>

    
      <div id="method-i-inspect" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">inspect</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="inspect-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 819</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">inspect</span>
  <span class="ruby-node">%Q(#&lt;Capybara::Session&gt;)</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-open_new_window" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">open_new_window</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Open new window. Current window doesn&#39;t change as the result of this
call. It should be switched to explicitly.</p>

<p>@return [Capybara::Window]   window that has been opened</p>
          
          

          
          <div class="method-source-code" id="open_new_window-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 475</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">open_new_window</span>
  <span class="ruby-identifier">window_opened_by</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">open_new_window</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-raise_server_error-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">raise_server_error!</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Raise errors encountered in the server</p>
          
          

          
          <div class="method-source-code" id="raise_server_error-21-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 139</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">raise_server_error!</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@server</span> <span class="ruby-keyword">and</span> <span class="ruby-ivar">@server</span>.<span class="ruby-identifier">error</span>
    <span class="ruby-comment"># Force an explanation for the error being raised as the exception cause</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">config</span>.<span class="ruby-identifier">raise_server_errors</span>
        <span class="ruby-identifier">raise</span> <span class="ruby-constant">CapybaraError</span>, <span class="ruby-string">&quot;Your application server raised an error - It has been raised in your test code because Capybara.raise_server_errors == true&quot;</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">rescue</span> <span class="ruby-constant">CapybaraError</span>
      <span class="ruby-comment">#needed to get the cause set correctly in JRuby -- otherwise we could just do raise @server.error</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-ivar">@server</span>.<span class="ruby-identifier">error</span>, <span class="ruby-ivar">@server</span>.<span class="ruby-identifier">error</span>.<span class="ruby-identifier">message</span>, <span class="ruby-ivar">@server</span>.<span class="ruby-identifier">error</span>.<span class="ruby-identifier">backtrace</span>
    <span class="ruby-keyword">ensure</span>
      <span class="ruby-ivar">@server</span>.<span class="ruby-identifier">reset_error!</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-refresh" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">refresh</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Refresh the page</p>
          
          

          
          <div class="method-source-code" id="refresh-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 282</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">refresh</span>
  <span class="ruby-identifier">raise_server_error!</span>
  <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">refresh</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-reset-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">reset!</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Reset the session (i.e. remove cookies and navigate to blank page)</p>

<p>This method does not:</p>

<pre>* accept modal dialogs if they are present (Selenium driver now does, others may not)
* clear browser cache/HTML 5 local storage/IndexedDB/Web SQL database/etc.
* modify state of the driver/underlying browser in any other way</pre>

<p>as doing so will result in performance downsides and it&#39;s not needed to
do everything from the list above for most apps.</p>

<p>If you want to do anything from the list above on a general basis you can:</p>

<pre>* write RSpec/Cucumber/etc. after hook
* monkeypatch this method
* use Ruby&#39;s `prepend` method</pre>
          
          

          
          <div class="method-source-code" id="reset-21-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 124</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">reset!</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@touched</span>
    <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">reset!</span>
    <span class="ruby-ivar">@touched</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@server</span>.<span class="ruby-identifier">wait_for_pending_requests</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@server</span>
  <span class="ruby-identifier">raise_server_error!</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Session.html#method-i-cleanup-21">cleanup!</a>, <a href="Session.html#method-i-reset_session-21">reset_session!</a>
        </div>
        

        
      </div>

    
      <div id="method-i-reset_session-21" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">reset_session!</span><span
            class="method-args">()</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Session.html#method-i-reset-21">reset!</a>
        </div>
        
      </div>

    
      <div id="method-i-response_headers" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">response_headers</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns a hash of response headers. Not supported by all drivers (e.g. <a
href="Selenium.html">Selenium</a>)</p>

<p>@return [Hash{String =&gt; String}] A hash of response headers.</p>
          
          

          
          <div class="method-source-code" id="response_headers-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 161</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">response_headers</span>
  <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">response_headers</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-save_and_open_page" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">save_and_open_page</span><span
            class="method-args">(path = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Save a snapshot of the page and open it in a browser for inspection.</p>

<p>If invoked without arguments it will save file to `Capybara.save_path`</p>

<pre>and file will be given randomly generated filename. If invoked with a relative path
the path will be relative to `Capybara.save_path`, which is different from
the previous behavior with `Capybara.save_and_open_page_path` where the relative path was
relative to Dir.pwd</pre>

<p>@param [String] path  the path to where it should be saved</p>
          
          

          
          <div class="method-source-code" id="save_and_open_page-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 760</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">save_and_open_page</span>(<span class="ruby-identifier">path</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">path</span> = <span class="ruby-identifier">save_page</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">open_file</span>(<span class="ruby-identifier">path</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-save_and_open_screenshot" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">save_and_open_screenshot</span><span
            class="method-args">(path = nil, options = {})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Save a screenshot of the page and open it for inspection.</p>

<p>If invoked without arguments it will save file to `Capybara.save_path`</p>

<pre>and file will be given randomly generated filename. If invoked with a relative path
the path will be relative to `Capybara.save_path`, which is different from
the previous behavior with `Capybara.save_and_open_page_path` where the relative path was
relative to Dir.pwd</pre>

<p>@param [String] path    the path to where it should be saved @param [Hash]
options   a customizable set of options</p>
          
          

          
          <div class="method-source-code" id="save_and_open_screenshot-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 797</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">save_and_open_screenshot</span>(<span class="ruby-identifier">path</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">options</span> = {})
  <span class="ruby-identifier">path</span> = <span class="ruby-identifier">save_screenshot</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">open_file</span>(<span class="ruby-identifier">path</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-save_page" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">save_page</span><span
            class="method-args">(path = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Save a snapshot of the page. If `Capybara.asset_host` is set it will inject
`base` tag</p>

<pre>pointing to `asset_host`.</pre>

<p>If invoked without arguments it will save file to `Capybara.save_path`</p>

<pre>and file will be given randomly generated filename. If invoked with a relative path
the path will be relative to `Capybara.save_path`, which is different from
the previous behavior with `Capybara.save_and_open_page_path` where the relative path was
relative to Dir.pwd</pre>

<p>@param [String] path  the path to where it should be saved @return [String]
the path to which the file was saved</p>
          
          

          
          <div class="method-source-code" id="save_page-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 742</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">save_page</span>(<span class="ruby-identifier">path</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">path</span> = <span class="ruby-identifier">prepare_path</span>(<span class="ruby-identifier">path</span>, <span class="ruby-string">&#39;html&#39;</span>)
  <span class="ruby-constant">File</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">path</span>, <span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">Helpers</span>.<span class="ruby-identifier">inject_asset_host</span>(<span class="ruby-identifier">body</span>, <span class="ruby-identifier">config</span>.<span class="ruby-identifier">asset_host</span>), <span class="ruby-identifier">mode</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;wb&#39;</span>)
  <span class="ruby-identifier">path</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-save_screenshot" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">save_screenshot</span><span
            class="method-args">(path = nil, options = {})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Save a screenshot of page.</p>

<p>If invoked without arguments it will save file to `Capybara.save_path`</p>

<pre>and file will be given randomly generated filename. If invoked with a relative path
the path will be relative to `Capybara.save_path`, which is different from
the previous behavior with `Capybara.save_and_open_page_path` where the relative path was
relative to Dir.pwd</pre>

<p>@param [String] path    the path to where it should be saved @param [Hash]
options   a customizable set of options @return [String]        the path to
which the file was saved</p>
          
          

          
          <div class="method-source-code" id="save_screenshot-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 778</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">save_screenshot</span>(<span class="ruby-identifier">path</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">options</span> = {})
  <span class="ruby-identifier">path</span> = <span class="ruby-identifier">prepare_path</span>(<span class="ruby-identifier">path</span>, <span class="ruby-string">&#39;png&#39;</span>)
  <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">save_screenshot</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">path</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-source" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">source</span><span
            class="method-args">()</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Session.html#method-i-html">html</a>
        </div>
        
      </div>

    
      <div id="method-i-status_code" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">status_code</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns the current HTTP status code as an Integer. Not supported by all
drivers (e.g. <a href="Selenium.html">Selenium</a>)</p>

<p>@return [Integer] Current HTTP status code</p>
          
          

          
          <div class="method-source-code" id="status_code-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 171</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">status_code</span>
  <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">status_code</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-switch_to_frame" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">switch_to_frame</span><span
            class="method-args">(frame)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Switch to the given frame</p>

<p>If you use this method you are responsible for making sure you switch back
to the parent frame when done in the frame changed to. <a
href="Session.html#method-i-within_frame">#within_frame</a> is preferred
over this method and should be used when possible. May not be supported by
all drivers.</p>

<p>@overload <a
href="Session.html#method-i-switch_to_frame">#switch_to_frame</a>(element)</p>

<pre>@param [Capybara::Node::Element]  iframe/frame element to switch to</pre>

<p>@overload <a
href="Session.html#method-i-switch_to_frame">#switch_to_frame</a>(:parent)</p>

<pre class="ruby"><span class="ruby-constant">Switch</span> <span class="ruby-identifier">to</span> <span class="ruby-identifier">the</span> <span class="ruby-identifier">parent</span> <span class="ruby-identifier">element</span>
</pre>

<p>@overload <a
href="Session.html#method-i-switch_to_frame">#switch_to_frame</a>(:top)</p>

<pre class="ruby"><span class="ruby-constant">Switch</span> <span class="ruby-identifier">to</span> <span class="ruby-identifier">the</span> <span class="ruby-identifier">top</span> <span class="ruby-identifier">level</span> <span class="ruby-identifier">document</span>
</pre>
          
          

          
          <div class="method-source-code" id="switch_to_frame-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 388</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">switch_to_frame</span>(<span class="ruby-identifier">frame</span>)
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">frame</span>
  <span class="ruby-keyword">when</span> <span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">Node</span><span class="ruby-operator">::</span><span class="ruby-constant">Element</span>
    <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">switch_to_frame</span>(<span class="ruby-identifier">frame</span>)
    <span class="ruby-identifier">scopes</span>.<span class="ruby-identifier">push</span>(<span class="ruby-value">:frame</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-value">:parent</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">ScopeError</span>, <span class="ruby-string">&quot;`switch_to_frame(:parent)` cannot be called from inside a descendant frame&#39;s &quot;</span>                                     <span class="ruby-string">&quot;`within` block.&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">scopes</span>.<span class="ruby-identifier">last</span>() <span class="ruby-operator">!=</span> <span class="ruby-value">:frame</span>
    <span class="ruby-identifier">scopes</span>.<span class="ruby-identifier">pop</span>
    <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">switch_to_frame</span>(<span class="ruby-value">:parent</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-value">:top</span>
    <span class="ruby-identifier">idx</span> = <span class="ruby-identifier">scopes</span>.<span class="ruby-identifier">index</span>(<span class="ruby-value">:frame</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">idx</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">ScopeError</span>, <span class="ruby-string">&quot;`switch_to_frame(:top)` cannot be called from inside a descendant frame&#39;s &quot;</span>                                       <span class="ruby-string">&quot;`within` block.&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">scopes</span>.<span class="ruby-identifier">slice</span>(<span class="ruby-identifier">idx</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>).<span class="ruby-identifier">any?</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">scope</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span>[<span class="ruby-value">:frame</span>, <span class="ruby-keyword">nil</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">scope</span>)}
      <span class="ruby-identifier">scopes</span>.<span class="ruby-identifier">slice!</span>(<span class="ruby-identifier">idx</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>)
      <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">switch_to_frame</span>(<span class="ruby-value">:top</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-switch_to_window" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">switch_to_window</span><span
            class="method-args">(window = nil, options= {}, &window_locator)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@overload <a
href="Session.html#method-i-switch_to_window">#switch_to_window</a>(&amp;block)</p>

<pre>Switches to the first window for which given block returns a value other than false or nil.
If window that matches block can&#39;t be found, the window will be switched back and `WindowError` will be raised.
@example
  window = switch_to_window { title == &#39;Page title&#39; }
@raise [Capybara::WindowError]     if no window matches given block</pre>

<p>@overload <a
href="Session.html#method-i-switch_to_window">#switch_to_window</a>(window)</p>

<pre>@param window [Capybara::Window]   window that should be switched to
@raise [Capybara::Driver::Base#no_such_window_error] if non-existent (e.g. closed) window was passed</pre>

<p>@return [Capybara::Window]         window that has been switched to @raise
[Capybara::ScopeError]        if this method is invoked inside `within` or</p>

<pre>`within_frame` methods</pre>

<p>@raise [ArgumentError]               if both or neither arguments were
provided</p>
          
          

          
          <div class="method-source-code" id="switch_to_window-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 497</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">switch_to_window</span>(<span class="ruby-identifier">window</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">options</span>= {}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">window_locator</span>)
  <span class="ruby-identifier">options</span>, <span class="ruby-identifier">window</span> = <span class="ruby-identifier">window</span>, <span class="ruby-keyword">nil</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">window</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Hash</span>

  <span class="ruby-identifier">block_given</span> = <span class="ruby-identifier">block_given?</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">window</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">block_given</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-string">&quot;`switch_to_window` can take either a block or a window, not both&quot;</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-operator">!</span><span class="ruby-identifier">window</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">block_given</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-string">&quot;`switch_to_window`: either window or block should be provided&quot;</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-operator">!</span><span class="ruby-identifier">scopes</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">ScopeError</span>, <span class="ruby-string">&quot;`switch_to_window` is not supposed to be invoked from &quot;</span>                                     <span class="ruby-string">&quot;`within` or `within_frame` blocks.&quot;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">_switch_to_window</span>(<span class="ruby-identifier">window</span>, <span class="ruby-identifier">options</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">window_locator</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-using_wait_time" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">using_wait_time</span><span
            class="method-args">(seconds) { || ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Yield a block using a specific wait time</p>
          
          

          
          <div class="method-source-code" id="using_wait_time-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 833</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">using_wait_time</span>(<span class="ruby-identifier">seconds</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Capybara</span>.<span class="ruby-identifier">threadsafe</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-identifier">previous_wait_time</span> = <span class="ruby-identifier">config</span>.<span class="ruby-identifier">default_max_wait_time</span>
      <span class="ruby-identifier">config</span>.<span class="ruby-identifier">default_max_wait_time</span> = <span class="ruby-identifier">seconds</span>
      <span class="ruby-keyword">yield</span>
    <span class="ruby-keyword">ensure</span>
      <span class="ruby-identifier">config</span>.<span class="ruby-identifier">default_max_wait_time</span> = <span class="ruby-identifier">previous_wait_time</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-constant">Capybara</span>.<span class="ruby-identifier">using_wait_time</span>(<span class="ruby-identifier">seconds</span>) { <span class="ruby-keyword">yield</span> }
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-visit" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">visit</span><span
            class="method-args">(visit_uri)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Navigate to the given URL. The URL can either be a relative URL or an
absolute URL The behaviour of either depends on the driver.</p>

<pre class="ruby"><span class="ruby-identifier">session</span>.<span class="ruby-identifier">visit</span>(<span class="ruby-string">&#39;/foo&#39;</span>)
<span class="ruby-identifier">session</span>.<span class="ruby-identifier">visit</span>(<span class="ruby-string">&#39;http://google.com&#39;</span>)
</pre>

<p>For drivers which can run against an external application, such as the
selenium driver giving an absolute URL will navigate to that page. This
allows testing applications running on remote servers. For these drivers,
setting {Capybara.app_host} will make the remote server the default. For
example:</p>

<pre class="ruby"><span class="ruby-constant">Capybara</span>.<span class="ruby-identifier">app_host</span> = <span class="ruby-string">&#39;http://google.com&#39;</span>
<span class="ruby-identifier">session</span>.<span class="ruby-identifier">visit</span>(<span class="ruby-string">&#39;/&#39;</span>) <span class="ruby-comment"># visits the google homepage</span>
</pre>

<p>If {Capybara.always_include_port} is set to true and this session is
running against a rack application, then the port that the rack application
is running on will automatically be inserted into the URL. Supposing the
app is running on port `4567`, doing something like:</p>

<pre class="ruby"><span class="ruby-identifier">visit</span>(<span class="ruby-string">&quot;http://google.com/test&quot;</span>)
</pre>

<p>Will actually navigate to `<a
href="http://google.com:4567/test">google.com:4567/test</a>`.</p>

<p>@param [#to_s] visit_uri     The URL to navigate to. The parameter will be
cast to a String.</p>
          
          

          
          <div class="method-source-code" id="visit-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 245</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">visit</span>(<span class="ruby-identifier">visit_uri</span>)
  <span class="ruby-identifier">raise_server_error!</span>
  <span class="ruby-ivar">@touched</span> = <span class="ruby-keyword">true</span>

  <span class="ruby-identifier">visit_uri</span> = <span class="ruby-operator">::</span><span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">visit_uri</span>.<span class="ruby-identifier">to_s</span>)

  <span class="ruby-identifier">uri_base</span> = <span class="ruby-keyword">if</span> <span class="ruby-ivar">@server</span>
    <span class="ruby-operator">::</span><span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">config</span>.<span class="ruby-identifier">app_host</span> <span class="ruby-operator">||</span> <span class="ruby-node">&quot;http://#{@server.host}:#{@server.port}&quot;</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">config</span>.<span class="ruby-identifier">app_host</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">::</span><span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">config</span>.<span class="ruby-identifier">app_host</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">uri_base</span> <span class="ruby-operator">&amp;&amp;</span> [<span class="ruby-keyword">nil</span>, <span class="ruby-string">&#39;http&#39;</span>, <span class="ruby-string">&#39;https&#39;</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">visit_uri</span>.<span class="ruby-identifier">scheme</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">visit_uri</span>.<span class="ruby-identifier">relative?</span>
      <span class="ruby-identifier">uri_base</span>.<span class="ruby-identifier">port</span> <span class="ruby-operator">||=</span> <span class="ruby-ivar">@server</span>.<span class="ruby-identifier">port</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@server</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">config</span>.<span class="ruby-identifier">always_include_port</span>

      <span class="ruby-identifier">visit_uri_parts</span> = <span class="ruby-identifier">visit_uri</span>.<span class="ruby-identifier">to_hash</span>.<span class="ruby-identifier">delete_if</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">nil?</span> }

      <span class="ruby-comment"># TODO - this is only for compatability with previous 2.x behavior that concatenated</span>
      <span class="ruby-comment"># Capybara.app_host and a &quot;relative&quot; path - Consider removing in 3.0</span>
      <span class="ruby-comment"># @abotalov brought up a good point about this behavior potentially being useful to people</span>
      <span class="ruby-comment"># deploying to a subdirectory and/or single page apps where only the url fragment changes</span>
      <span class="ruby-identifier">visit_uri_parts</span>[<span class="ruby-value">:path</span>] = <span class="ruby-identifier">uri_base</span>.<span class="ruby-identifier">path</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">visit_uri</span>.<span class="ruby-identifier">path</span>

      <span class="ruby-identifier">visit_uri</span> = <span class="ruby-identifier">uri_base</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">visit_uri_parts</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">visit_uri</span>.<span class="ruby-identifier">port</span> <span class="ruby-operator">||=</span> <span class="ruby-ivar">@server</span>.<span class="ruby-identifier">port</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@server</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">config</span>.<span class="ruby-identifier">always_include_port</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">visit</span>(<span class="ruby-identifier">visit_uri</span>.<span class="ruby-identifier">to_s</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-window_opened_by" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">window_opened_by</span><span
            class="method-args">(options = {}, &block)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get the window that has been opened by the passed block. It will wait for
it to be opened (in the same way as other <a
href="../Capybara.html">Capybara</a> methods wait). It&#39;s better to use
this method than `windows.last` {<a
href="https://dvcs.w3.org/hg/webdriver/raw-file/default/webdriver-spec.html#h_note_10">dvcs.w3.org/hg/webdriver/raw-file/default/webdriver-spec.html#h_note_10</a>
as order of windows isn&#39;t defined in some drivers}</p>

<p>@param options [Hash] @option options [Numeric] :wait
(Capybara.default_max_wait_time) maximum wait time @return
[Capybara::Window]       the window that has been opened within a block
@raise [Capybara::WindowError]   if block passed to window hasn&#39;t
opened window</p>

<pre>or opened more than one window</pre>
          
          

          
          <div class="method-source-code" id="window_opened_by-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 590</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">window_opened_by</span>(<span class="ruby-identifier">options</span> = {}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">old_handles</span> = <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">window_handles</span>
  <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>

  <span class="ruby-identifier">wait_time</span> = <span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">Queries</span><span class="ruby-operator">::</span><span class="ruby-constant">BaseQuery</span>.<span class="ruby-identifier">wait</span>(<span class="ruby-identifier">options</span>, <span class="ruby-identifier">config</span>.<span class="ruby-identifier">default_max_wait_time</span>)
  <span class="ruby-identifier">document</span>.<span class="ruby-identifier">synchronize</span>(<span class="ruby-identifier">wait_time</span>, <span class="ruby-identifier">errors</span><span class="ruby-operator">:</span> [<span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">WindowError</span>]) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">opened_handles</span> = (<span class="ruby-identifier">driver</span>.<span class="ruby-identifier">window_handles</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">old_handles</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">opened_handles</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">!=</span> <span class="ruby-value">1</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">WindowError</span>, <span class="ruby-node">&quot;block passed to #window_opened_by &quot;</span>                                        <span class="ruby-node">&quot;opened #{opened_handles.size} windows instead of 1&quot;</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-constant">Window</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">self</span>, <span class="ruby-identifier">opened_handles</span>.<span class="ruby-identifier">first</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-windows" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">windows</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get all opened windows. The order of windows in returned array is not
defined. The driver may sort windows by their creation time but it&#39;s
not required.</p>

<p>@return [Array&lt;Capybara::Window&gt;]   an array of all windows</p>
          
          

          
          <div class="method-source-code" id="windows-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 462</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">windows</span>
  <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">window_handles</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">handle</span><span class="ruby-operator">|</span>
    <span class="ruby-constant">Window</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">self</span>, <span class="ruby-identifier">handle</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-within" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">within</span><span
            class="method-args">(*args) { || ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Executes the given block within the context of a node. `within` takes the
same options as `find`, as well as a block. For the duration of the block,
any command to <a href="../Capybara.html">Capybara</a> will be handled as
though it were scoped to the given element.</p>

<pre class="ruby"><span class="ruby-identifier">within</span>(:<span class="ruby-identifier">xpath</span>, <span class="ruby-string">&#39;.//div[@id=&quot;delivery-address&quot;]&#39;</span>) <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">fill_in</span>(<span class="ruby-string">&#39;Street&#39;</span>, <span class="ruby-identifier">with</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;12 Main Street&#39;</span>)
<span class="ruby-keyword">end</span>
</pre>

<p>Just as with `find`, if multiple elements match the selector given to
`within`, an error will be raised, and just as with `find`, this behaviour
can be controlled through the `:match` and `:exact` options.</p>

<p>It is possible to omit the first parameter, in that case, the selector is
assumed to be of the type set in Capybara.default_selector.</p>

<pre class="ruby"><span class="ruby-identifier">within</span>(<span class="ruby-string">&#39;div#delivery-address&#39;</span>) <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">fill_in</span>(<span class="ruby-string">&#39;Street&#39;</span>, <span class="ruby-identifier">with</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;12 Main Street&#39;</span>)
<span class="ruby-keyword">end</span>
</pre>

<p>Note that a lot of uses of `within` can be replaced more succinctly with
chaining:</p>

<pre class="ruby"><span class="ruby-identifier">find</span>(<span class="ruby-string">&#39;div#delivery-address&#39;</span>).<span class="ruby-identifier">fill_in</span>(<span class="ruby-string">&#39;Street&#39;</span>, <span class="ruby-identifier">with</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;12 Main Street&#39;</span>)
</pre>

<p>@overload within(*find_args)</p>

<pre>@param (see Capybara::Node::Finders#all)</pre>

<p>@overload within(a_node)</p>

<pre>@param [Capybara::Node::Base] a_node   The node in whose scope the block should be evaluated</pre>

<p>@raise  [Capybara::ElementNotFound]      If the scope can&#39;t be found
before time expires</p>
          
          

          
          <div class="method-source-code" id="within-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 338</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">within</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
  <span class="ruby-identifier">new_scope</span> = <span class="ruby-keyword">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">Node</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>) <span class="ruby-keyword">then</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">first</span> <span class="ruby-keyword">else</span> <span class="ruby-identifier">find</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>) <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">scopes</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">new_scope</span>)
    <span class="ruby-keyword">yield</span>
  <span class="ruby-keyword">ensure</span>
    <span class="ruby-identifier">scopes</span>.<span class="ruby-identifier">pop</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Session.html#method-i-within_element">within_element</a>
        </div>
        

        
      </div>

    
      <div id="method-i-within_element" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">within_element</span><span
            class="method-args">(*args)</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Session.html#method-i-within">within</a>
        </div>
        
      </div>

    
      <div id="method-i-within_fieldset" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">within_fieldset</span><span
            class="method-args">(locator) { || ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Execute the given block within the a specific fieldset given the id or
legend of that fieldset.</p>

<p>@param [String] locator    Id or legend of the fieldset</p>
          
          

          
          <div class="method-source-code" id="within_fieldset-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 355</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">within_fieldset</span>(<span class="ruby-identifier">locator</span>)
  <span class="ruby-identifier">within</span> <span class="ruby-value">:fieldset</span>, <span class="ruby-identifier">locator</span> <span class="ruby-keyword">do</span>
    <span class="ruby-keyword">yield</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-within_frame" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">within_frame</span><span
            class="method-args">(*args) { || ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Execute the given block within the given iframe using given frame, frame
name/id or index. May not be supported by all drivers.</p>

<p>@overload <a
href="Session.html#method-i-within_frame">#within_frame</a>(element)</p>

<pre>@param [Capybara::Node::Element]  frame element</pre>

<p>@overload <a
href="Session.html#method-i-within_frame">#within_frame</a>([kind =
:frame], locator, options = {})</p>

<pre>@param [Symobl] kind      Optional selector type (:css, :xpath, :field, etc.) - Defaults to :frame
@param [String] locator   The locator for the given selector kind.  For :frame this is the name/id of a frame/iframe element</pre>

<p>@overload <a
href="Session.html#method-i-within_frame">#within_frame</a>(index)</p>

<pre>@param [Integer] index         index of a frame (0 based)</pre>
          
          

          
          <div class="method-source-code" id="within_frame-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 421</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">within_frame</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
  <span class="ruby-identifier">frame</span> = <span class="ruby-identifier">_find_frame</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)

  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">switch_to_frame</span>(<span class="ruby-identifier">frame</span>)
    <span class="ruby-keyword">begin</span>
      <span class="ruby-keyword">yield</span>
    <span class="ruby-keyword">ensure</span>
      <span class="ruby-identifier">switch_to_frame</span>(<span class="ruby-value">:parent</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">NotSupportedByDriverError</span>
    <span class="ruby-comment"># Support older driver frame API for now</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:within_frame</span>)
      <span class="ruby-keyword">begin</span>
        <span class="ruby-identifier">scopes</span>.<span class="ruby-identifier">push</span>(<span class="ruby-value">:frame</span>)
        <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">within_frame</span>(<span class="ruby-identifier">frame</span>) <span class="ruby-keyword">do</span>
          <span class="ruby-keyword">yield</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">ensure</span>
        <span class="ruby-identifier">scopes</span>.<span class="ruby-identifier">pop</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">raise</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-within_table" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">within_table</span><span
            class="method-args">(locator) { || ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Execute the given block within the a specific table given the id or caption
of that table.</p>

<p>@param [String] locator    Id or caption of the table</p>
          
          

          
          <div class="method-source-code" id="within_table-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 367</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">within_table</span>(<span class="ruby-identifier">locator</span>)
  <span class="ruby-identifier">within</span> <span class="ruby-value">:table</span>, <span class="ruby-identifier">locator</span> <span class="ruby-keyword">do</span>
    <span class="ruby-keyword">yield</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-within_window" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">within_window</span><span
            class="method-args">(window_or_handle) { || ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>This method does the following:</p>
<ol><li>
<p>Switches to the given window (it can be located by window
instance/lambda/string).</p>
</li><li>
<p>Executes the given block (within window located at previous step).</p>
</li><li>
<p>Switches back (this step will be invoked even if exception will happen at
second step)</p>
</li></ol>

<p>@overload <a
href="Session.html#method-i-within_window">#within_window</a>(window) {
do_something }</p>

<pre>@param window [Capybara::Window]       instance of `Capybara::Window` class
  that will be switched to
@raise [driver#no_such_window_error] if unexistent (e.g. closed) window was passed</pre>

<p>@overload <a
href="Session.html#method-i-within_window">#within_window</a>(proc_or_lambda)
{ do_something }</p>

<pre>@param lambda [Proc]                  lambda. First window for which lambda
  returns a value other than false or nil will be switched to.
@example
  within_window(-&gt;{ page.title == &#39;Page title&#39; }) { click_button &#39;Submit&#39; }
@raise [Capybara::WindowError]         if no window matching lambda was found</pre>

<p>@overload <a
href="Session.html#method-i-within_window">#within_window</a>(string) {
do_something }</p>

<pre>@deprecated                            Pass window or lambda instead
@param [String]                        handle, name, url or title of the window</pre>

<p>@raise [Capybara::ScopeError]        if this method is invoked inside
`within_frame` method @return                              value returned
by the block</p>
          
          

          
          <div class="method-source-code" id="within_window-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 537</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">within_window</span>(<span class="ruby-identifier">window_or_handle</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">window_or_handle</span>.<span class="ruby-identifier">instance_of?</span>(<span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">Window</span>)
    <span class="ruby-identifier">original</span> = <span class="ruby-identifier">current_window</span>
    <span class="ruby-identifier">scopes</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-identifier">_switch_to_window</span>(<span class="ruby-identifier">window_or_handle</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">original</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">window_or_handle</span>
      <span class="ruby-keyword">begin</span>
        <span class="ruby-keyword">yield</span>
      <span class="ruby-keyword">ensure</span>
        <span class="ruby-identifier">_switch_to_window</span>(<span class="ruby-identifier">original</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">original</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">window_or_handle</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">ensure</span>
      <span class="ruby-identifier">scopes</span>.<span class="ruby-identifier">pop</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">window_or_handle</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Proc</span>)
    <span class="ruby-identifier">original</span> = <span class="ruby-identifier">current_window</span>
    <span class="ruby-identifier">scopes</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-identifier">_switch_to_window</span> { <span class="ruby-identifier">window_or_handle</span>.<span class="ruby-identifier">call</span> }
      <span class="ruby-keyword">begin</span>
        <span class="ruby-keyword">yield</span>
      <span class="ruby-keyword">ensure</span>
        <span class="ruby-identifier">_switch_to_window</span>(<span class="ruby-identifier">original</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">ensure</span>
      <span class="ruby-identifier">scopes</span>.<span class="ruby-identifier">pop</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">offending_line</span> = <span class="ruby-identifier">caller</span>.<span class="ruby-identifier">first</span>
    <span class="ruby-identifier">file_line</span> = <span class="ruby-identifier">offending_line</span>.<span class="ruby-identifier">match</span>(<span class="ruby-regexp">/^(.+?):(\d+)/</span>)[<span class="ruby-value">0</span>]
    <span class="ruby-identifier">warn</span> <span class="ruby-node">&quot;DEPRECATION WARNING: Passing string argument to #within_window is deprecated. &quot;</span>              <span class="ruby-node">&quot;Pass window object or lambda. (called from #{file_line})&quot;</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-identifier">scopes</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-keyword">nil</span>
      <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">within_window</span>(<span class="ruby-identifier">window_or_handle</span>) { <span class="ruby-keyword">yield</span> }
    <span class="ruby-keyword">ensure</span>
      <span class="ruby-identifier">scopes</span>.<span class="ruby-identifier">pop</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="private-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Private Instance Methods</h3>
       </header>

    
      <div id="method-i-_find_frame" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_find_frame</span><span
            class="method-args">(*args)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_find_frame-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 930</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_find_frame</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
  <span class="ruby-identifier">within</span>(<span class="ruby-identifier">document</span>) <span class="ruby-keyword">do</span>  <span class="ruby-comment"># Previous 2.x versions ignored current scope when finding frames - consider changing in 3.0</span>
    <span class="ruby-keyword">case</span> <span class="ruby-identifier">args</span>[<span class="ruby-value">0</span>]
    <span class="ruby-keyword">when</span> <span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">Node</span><span class="ruby-operator">::</span><span class="ruby-constant">Element</span>
      <span class="ruby-identifier">args</span>[<span class="ruby-value">0</span>]
    <span class="ruby-keyword">when</span> <span class="ruby-constant">String</span>, <span class="ruby-constant">Hash</span>
      <span class="ruby-identifier">find</span>(<span class="ruby-value">:frame</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
    <span class="ruby-keyword">when</span> <span class="ruby-constant">Symbol</span>
      <span class="ruby-identifier">find</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
    <span class="ruby-keyword">when</span> <span class="ruby-constant">Integer</span>
      <span class="ruby-identifier">idx</span> = <span class="ruby-identifier">args</span>[<span class="ruby-value">0</span>]
      <span class="ruby-identifier">all</span>(<span class="ruby-value">:frame</span>, <span class="ruby-identifier">minimum</span><span class="ruby-operator">:</span> <span class="ruby-identifier">idx</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>)[<span class="ruby-identifier">idx</span>]
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_switch_to_window" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_switch_to_window</span><span
            class="method-args">(window = nil, options= {}) { || ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_switch_to_window-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 948</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_switch_to_window</span>(<span class="ruby-identifier">window</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">options</span>= {})
  <span class="ruby-identifier">options</span>, <span class="ruby-identifier">window</span> = <span class="ruby-identifier">window</span>, <span class="ruby-keyword">nil</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">window</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Hash</span>

  <span class="ruby-identifier">raise</span> <span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">ScopeError</span>, <span class="ruby-string">&quot;Window cannot be switched inside a `within_frame` block&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">scopes</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value">:frame</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">ScopeError</span>, <span class="ruby-string">&quot;Window cannot be switch inside a `within` block&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">scopes</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">nil?</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">window</span>
    <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">switch_to_window</span>(<span class="ruby-identifier">window</span>.<span class="ruby-identifier">handle</span>)
    <span class="ruby-identifier">window</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">wait_time</span> = <span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">Queries</span><span class="ruby-operator">::</span><span class="ruby-constant">BaseQuery</span>.<span class="ruby-identifier">wait</span>(<span class="ruby-identifier">options</span>, <span class="ruby-identifier">config</span>.<span class="ruby-identifier">default_max_wait_time</span>)
    <span class="ruby-identifier">document</span>.<span class="ruby-identifier">synchronize</span>(<span class="ruby-identifier">wait_time</span>, <span class="ruby-identifier">errors</span><span class="ruby-operator">:</span> [<span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">WindowError</span>]) <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">original_window_handle</span> = <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">current_window_handle</span>
      <span class="ruby-keyword">begin</span>
        <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">window_handles</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">handle</span><span class="ruby-operator">|</span>
          <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">switch_to_window</span> <span class="ruby-identifier">handle</span>
          <span class="ruby-keyword">if</span> <span class="ruby-keyword">yield</span>
            <span class="ruby-keyword">return</span> <span class="ruby-constant">Window</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">self</span>, <span class="ruby-identifier">handle</span>)
          <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
        <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">switch_to_window</span>(<span class="ruby-identifier">original_window_handle</span>)
        <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">switch_to_window</span>(<span class="ruby-identifier">original_window_handle</span>)
        <span class="ruby-identifier">raise</span> <span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">WindowError</span>, <span class="ruby-string">&quot;Could not find a window matching block/lambda&quot;</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-accept_modal" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">accept_modal</span><span
            class="method-args">(type, text_or_options, options, &blk)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="accept_modal-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 872</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">accept_modal</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">text_or_options</span>, <span class="ruby-identifier">options</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">blk</span>)
  <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">accept_modal</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">modal_options</span>(<span class="ruby-identifier">text_or_options</span>, <span class="ruby-identifier">options</span>), <span class="ruby-operator">&amp;</span><span class="ruby-identifier">blk</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-default_fn" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">default_fn</span><span
            class="method-args">(extension)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="default_fn-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 908</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">default_fn</span>(<span class="ruby-identifier">extension</span>)
  <span class="ruby-identifier">timestamp</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">strftime</span>(<span class="ruby-string">&quot;%Y%m%d%H%M%S&quot;</span>)
  <span class="ruby-node">&quot;capybara-#{timestamp}#{rand(10**10)}.#{extension}&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-dismiss_modal" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">dismiss_modal</span><span
            class="method-args">(type, text_or_options, options, &blk)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="dismiss_modal-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 876</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">dismiss_modal</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">text_or_options</span>, <span class="ruby-identifier">options</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">blk</span>)
  <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">dismiss_modal</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">modal_options</span>(<span class="ruby-identifier">text_or_options</span>, <span class="ruby-identifier">options</span>), <span class="ruby-operator">&amp;</span><span class="ruby-identifier">blk</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-element_script_result" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">element_script_result</span><span
            class="method-args">(arg)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="element_script_result-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 917</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">element_script_result</span>(<span class="ruby-identifier">arg</span>)
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">arg</span>
  <span class="ruby-keyword">when</span> <span class="ruby-constant">Array</span>
    <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span> <span class="ruby-identifier">element_script_result</span>(<span class="ruby-identifier">e</span>) }
  <span class="ruby-keyword">when</span> <span class="ruby-constant">Hash</span>
    <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">arg</span>[<span class="ruby-identifier">k</span>] = <span class="ruby-identifier">element_script_result</span>(<span class="ruby-identifier">v</span>) }
  <span class="ruby-keyword">when</span> <span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">Driver</span><span class="ruby-operator">::</span><span class="ruby-constant">Node</span>
    <span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">Node</span><span class="ruby-operator">::</span><span class="ruby-constant">Element</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">self</span>, <span class="ruby-identifier">arg</span>, <span class="ruby-keyword">nil</span>, <span class="ruby-keyword">nil</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">arg</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-modal_options" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">modal_options</span><span
            class="method-args">(text_or_options, options)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="modal_options-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 880</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">modal_options</span>(<span class="ruby-identifier">text_or_options</span>, <span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">text_or_options</span>, <span class="ruby-identifier">options</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">text_or_options</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">text_or_options</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
  <span class="ruby-identifier">options</span>[<span class="ruby-value">:text</span>] <span class="ruby-operator">||=</span> <span class="ruby-identifier">text_or_options</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">text_or_options</span>.<span class="ruby-identifier">nil?</span>
  <span class="ruby-identifier">options</span>[<span class="ruby-value">:wait</span>] <span class="ruby-operator">||=</span> <span class="ruby-identifier">config</span>.<span class="ruby-identifier">default_max_wait_time</span>
  <span class="ruby-identifier">options</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-open_file" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">open_file</span><span
            class="method-args">(path)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="open_file-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 888</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">open_file</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">require</span> <span class="ruby-string">&quot;launchy&quot;</span>
    <span class="ruby-constant">Launchy</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">LoadError</span>
    <span class="ruby-identifier">warn</span> <span class="ruby-node">&quot;File saved to #{path}.&quot;</span>
    <span class="ruby-identifier">warn</span> <span class="ruby-string">&quot;Please install the launchy gem to open the file automatically.&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-prepare_path" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">prepare_path</span><span
            class="method-args">(path, extension)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="prepare_path-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 898</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">prepare_path</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">extension</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">config</span>.<span class="ruby-identifier">save_path</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">config</span>.<span class="ruby-identifier">save_and_open_page_path</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">path</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-identifier">path</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">default_fn</span>(<span class="ruby-identifier">extension</span>), <span class="ruby-identifier">config</span>.<span class="ruby-identifier">save_path</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">path</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-identifier">default_fn</span>(<span class="ruby-identifier">extension</span>), <span class="ruby-identifier">config</span>.<span class="ruby-identifier">save_and_open_page_path</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">path</span>.<span class="ruby-identifier">nil?</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-identifier">path</span>))
  <span class="ruby-identifier">path</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-scopes" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">scopes</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="scopes-source">
            <pre><span class="ruby-comment"># File lib/capybara/session.rb, line 913</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">scopes</span>
  <span class="ruby-ivar">@scopes</span> <span class="ruby-operator">||=</span> [<span class="ruby-keyword">nil</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://rdoc.github.io/rdoc">RDoc</a> 5.1.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

